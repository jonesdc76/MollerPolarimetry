{//Digitization of Figures 1 and 2 from Danan 1959 "Sur l'interpretation des mesures d'aimantation du fer et du nickel purs polycristallins au voisinage de la saturation"
  gStyle->SetTitleW(0.8);
  bool draw_vs_H = 1;
  TGaxis::SetMaxDigits(4);
  TCanvas *c = new TCanvas("c","c",0,0,660,500);
  c->SetGrid();
  const int N = 33, N2 = 89;
  double HFeR[N] = {0.03551, 0.04017, 0.09126, 0.04759, 0.05587, 0.06866, 0.08866, 0.12895, 0.16360, 0.19827, 0.21007, 0.20912, 0.25013, 0.22837, 0.29310, 0.36874, 0.3696480378516221, 0.4224972238925199, 0.5801450159543885, 0.6540048367912149, 0.7086403876455537, 0.7424452569161288, 0.7825550722665766, 0.8208960792145261, 0.8673240079530542, 0.9184241365537642, 1.0085609448860369, 1.0752138590307982, 1.1964847676189554, 1.2932205919143949, 1.4018157718017707, 1.5981908118523331,  1.7526586989821666};
  double m_Fe[N] = {218.00568, 217.91716, 217.85066, 217.80878, 217.74197, 217.71134, 217.73859, 217.56358, 217.52407, 217.47372, 217.50634, 217.54248, 217.51386, 217.44141, 217.38405, 217.34483,217.34484082918930, 217.32353612451007, 217.25057936156114, 217.17701690243464, 217.18464077388660, 217.09633092956807, 217.06589798847423, 216.99207876683770, 217.0086794506599, 216.9277235479751,  216.95006188634858, 216.8113870881376, 216.69479386579002, 216.5328425584958,  216.35471192124194, 215.88986643960376, 215.43556138818542};

  double curveFeXR[N2]={  0.02825, 0.04113, 0.05672, 0.0901963, 0.1102606, 0.1259643, 0.1448999, 0.1641936, 0.1875700, 0.2346587, 0.2545963, 0.2742439, 0.2919695, 0.3118779, 0.3325178, 0.3525502, 0.3725799, 0.3926154, 0.4126468, 0.4392051, 0.4599958, 0.4800294, 0.4999142, 0.5200964, 0.5401308, 0.5601636, 0.5801950, 0.6002320, 0.6202680, 0.6382160, 0.7004492, 0.6803710, 0.7243529, 0.7690656, 0.8078771, 0.8265169, 0.8443119, 0.8643436, 0.8821105, 0.9026114, 0.9178829, 0.9323183, 0.9536185, 0.9736579, 0.9944564, 1.0137445, 1.0337787, 1.0545762, 1.0920832, 1.1121254, 1.1321690, 1.1522111, 1.1722569, 1.1926044, 1.2123472, 1.2323942, 1.2524413, 1.2724889, 1.2925421, 1.3126005, 1.3326529, 1.3527078, 1.3727594, 1.3928138, 1.4128678, 1.4329222, 1.4529747, 1.4730294, 1.4930842, 1.5131387, 1.5331954, 1.5532513, 1.5733073, 1.5940976, 1.6134158, 1.6306757, 1.6517158, 1.6717763, 1.6918344, 1.7118955, 1.7319554, 1.7511069, 1.7702589, 1.7903196, 1.8103815, 1.8304434, 1.8495940, 1.8678364, 1.8869925};
  double curveFeY[N2] = {  217.9821, 217.8810, 217.7871, 217.6644, 217.6244, 217.5956, 217.5693, 217.5394, 217.5190, 217.4762, 217.4620, 217.4440, 217.4319, 217.4203, 217.4057, 217.3919, 217.3803, 217.3640, 217.3509, 217.3325, 217.3187, 217.3039, 217.2867, 217.2745, 217.2590, 217.2449, 217.2319, 217.2143, 217.1975, 217.1846, 217.1349, 217.1514, 217.1116, 217.0741, 217.0412, 217.0216, 217.0060, 216.9928, 216.9715, 216.9466, 216.9333, 216.9191, 216.8986, 216.8791, 216.8587, 216.8335, 216.8183, 216.7988, 216.7547, 216.7329, 216.7099, 216.6880, 216.6632, 216.6396, 216.6146, 216.5888, 216.5629, 216.5366, 216.5057, 216.4704, 216.4402, 216.4078, 216.3783, 216.3463, 216.3147, 216.2829, 216.2525, 216.2203, 216.1881, 216.1561, 216.1222, 216.0891, 216.0559, 216.0173, 215.9923, 215.9564, 215.9196, 215.8826, 215.8477, 215.8102, 215.7738, 215.7362, 215.6982, 215.6611, 215.6230, 215.5849, 215.5480, 215.5099, 215.4685};

  TGraph *grFe = new TGraph();
  for(int i=0;i<N;++i) grFe->SetPoint(i,(draw_vs_H ? 1e3/HFeR[i]:HFeR[i]/1000.),m_Fe[i]);
  grFe->SetMarkerColor(kBlue);
  grFe->SetMarkerStyle(20);
  //  grFe->GetXaxis()->SetRangeUser(0,2);
  grFe->GetYaxis()->SetRangeUser(215,218.2);
  grFe->Draw("ap");
  if(draw_vs_H)
    grFe->SetTitle("Fe Saturation Magnetization vs Internal Field H_{i} (Danan 1959)");
  else
    grFe->SetTitle("Fe Saturation Magnetization vs 1/H_{i} (Danan 1959)");
  grFe->GetYaxis()->SetTitle("M_{s}(emu/g)");
  grFe->GetYaxis()->SetTitleOffset(1.3);
  if(draw_vs_H)
    grFe->GetXaxis()->SetTitle("H_{i} (kOe)");
  else
    grFe->GetXaxis()->SetTitle("1/H_{i} (Oe^{-1})");
  TGraph *grFeC = new TGraph();
  for(int i=0;i<N2;++i) grFeC->SetPoint(i,(draw_vs_H ? 1e3/curveFeXR[i]:curveFeXR[i]/1000.),curveFeY[i]);
  grFeC->SetLineColor(kRed);
  grFeC->Draw("samec");
  if(draw_vs_H)
    c->SaveAs("Danan1959FeMvsH.pdf");
  else
    c->SaveAs("Danan1959FeMvsHinverse.pdf");
  double arajX[15] = {1.83963, 1.59581, 1.38579, 1.24863, 1.10280, 0.92821, 0.71221, 0.61922, 0.51771, 0.47053, 0.41331, 0.33462, 0.28456, 0.25172, 0.23176};
  double arajY[15] = {215.06297, 215.87245, 216.27994, 216.54179, 216.75649, 216.88718, 217.12381, 217.21786, 217.36050, 217.42667, 217.48839, 217.56186, 217.62213, 217.69717, 217.77076};

  for(int i=0;i<15;++i)arajX[i]= (draw_vs_H? 1000/arajX[i] : arajX[i]/1000.);
  TGraph *grAraj = new TGraph(15, arajX, arajY);
  grAraj->SetMarkerColor(kBlack);
  grAraj->SetMarkerStyle(3);
  grAraj->Draw("samepc");



  TCanvas *c2 = new TCanvas("c2","c2",660,0,660,500);
  c2->SetGrid();

  double HNiR[53] = {0.03762, 0.04104, 0.04831, 0.04155, 0.05200, 0.06006, 0.05769, 0.06668, 0.09876, 0.10033, 0.09959, 0.11865, 0.11786, 0.11508, 0.14805, 0.17440, 0.18943, 0.21865, 0.23027, 0.23542, 0.26829, 0.27045, 0.29991, 0.33670, 0.36304, 0.36515, 0.40488, 0.45738, 0.47139, 0.50980, 0.52030, 0.55084, 0.55351, 0.57810, 0.60518, 0.65078, 0.71251, 0.74352, 0.78085, 0.80354, 0.84345, 0.89143, 0.94504, 0.99506, 1.00468, 1.29168, 1.47658, 1.71303, 1.80852, 1.11157, 0.91709, 0.45777, 0.05533};
  double m_Ni[53] = {55.36077, 55.48553, 55.42849, 55.34289, 55.47288, 55.34933, 55.37966, 55.44273, 55.35950, 55.32035, 55.28209, 55.35679, 55.31166, 55.27118, 55.27974, 55.30702, 55.25163, 55.20173, 55.27733, 55.18732, 55.17665, 55.15884, 55.21912, 55.23078, 55.12037, 55.13585, 55.11940, 55.18901, 55.10741, 55.16969, 55.12747, 55.09093, 55.11401, 55.12013, 55.13048, 55.10783, 55.10124, 55.11097, 55.03800, 55.07656, 55.07099, 55.09098, 55.05772, 55.01405, 55.06060, 54.98401, 54.96047, 54.86009, 54.82799, 55.01149, 55.01812, 55.17043, 55.45524};   
  double curveNiXR[96] = {0.03755, 0.04318, 0.04640, 0.05528, 0.05851, 0.06821, 0.07387, 0.08196, 0.08924, 0.12485, 0.13214, 0.16614, 0.17314, 0.21128, 0.23179, 0.25125, 0.27124, 0.29486, 0.31358, 0.33483, 0.35481, 0.37480, 0.39479, 0.41478, 0.43476, 0.45475, 0.47474, 0.49473, 0.51396, 0.53653, 0.55652, 0.61480, 0.63405, 0.65401, 0.67646, 0.69721, 0.73644, 0.75643, 0.77642, 0.79316, 0.82352, 0.86183, 0.88212, 0.90055, 0.92179, 0.96177, 0.98176, 1.00301, 1.02174, 1.04173, 1.06172, 1.08170, 1.12587, 1.14712, 1.16711, 1.18710, 1.20708, 1.22707, 1.24706, 1.26705, 1.28679, 1.30702, 1.32701, 1.34700, 1.36699, 1.38697, 1.40696, 1.42695, 1.44694, 1.46692, 1.48691, 1.50690, 1.52870, 1.54869, 1.56868, 1.58866, 1.60865, 1.62864, 1.64862, 1.66861, 1.68860, 1.70859, 1.72857, 1.74856, 1.76854, 1.78853, 1.80852, 1.82850, 1.84849, 1.86847, 1.88846, 1.90845, 1.92843, 1.94842, 1.96840, 1.98566};   
  double curveNiY[96] = {55.50374, 55.46171, 55.44393, 55.41240, 55.40189, 55.37764, 55.36632, 55.35177, 55.33964, 55.29677, 55.29111, 55.26603, 55.26157, 55.23914, 55.22892, 55.21967, 55.21083, 55.20218, 55.19471, 55.18540, 55.17871, 55.17227, 55.16682, 55.16062, 55.15525, 55.15078, 55.14596, 55.14061, 55.13547, 55.13043, 55.12710, 55.11970, 55.11671, 55.11324, 55.10998, 55.10609, 55.10170, 55.09676, 55.09161, 55.08776, 55.08310, 55.07447, 55.06987, 55.06543, 55.06034, 55.05174, 55.04546, 55.04031, 55.03497, 55.02943, 55.02455, 55.01918, 55.00607, 55.00034, 54.99554, 54.98976, 54.98332, 54.97663, 54.97117, 54.96514, 54.96057, 54.95324, 54.94688, 54.94085, 54.93457, 54.92821, 54.92202, 54.91566, 54.90971, 54.90401, 54.89797, 54.89138, 54.88377, 54.87749, 54.87105, 54.86427, 54.85758, 54.85048, 54.84387, 54.83726, 54.83090, 54.82397, 54.81686, 54.80910, 54.80183, 54.79383, 54.78582, 54.77847, 54.77029, 54.76311, 54.75502, 54.74792, 54.74007, 54.73231, 54.72397, 54.71741};
  TGraph *grNi = new TGraph();   
  for(int i=0;i<53;++i) grNi->SetPoint(i,(draw_vs_H ? 1e3/HNiR[i]:HNiR[i]/1000.),m_Ni[i]);
  grNi->SetMarkerColor(kBlue);
  grNi->SetMarkerStyle(20);
  grNi->Draw("ap");
  if(draw_vs_H)
    grNi->SetTitle("Ni Saturation Magnetization vs Internal Field H_{i} (Danan 1959)");
  else
    grNi->SetTitle("Ni Saturation Magnetization vs 1/H_{i} (Danan 1959)");
  grNi->GetYaxis()->SetTitle("M_{s}(emu/g)");
  grNi->GetYaxis()->SetTitleOffset(1.3);
  grNi->GetYaxis()->SetRangeUser(54.5, 55.6);
  if(draw_vs_H)
    grNi->GetXaxis()->SetTitle("H_{i} (kOe)");
  else
    grNi->GetXaxis()->SetTitle("1/H_{i} (Oe^{-1})");
  TGraph *grNiC = new TGraph();
  for(int i=0;i<96;++i) grNiC->SetPoint(i,(draw_vs_H ? 1e3/curveNiXR[i]:curveNiXR[i]/1000.),curveNiY[i]);
  grNiC->SetLineColor(kRed);
  grNiC->Draw("samec");
  if(draw_vs_H)
    c2->SaveAs("Danan1959NiMvsH.pdf");
  else
    c2->SaveAs("Danan1959NiMvsHinverse.pdf");
}
